from tkinter import *
from turtle import *
import random

#Generates the Dictionary with key = to the letter 
#and value = to the number of occurences.
#The function then removes items '\n' and ' ' from the dictionary.
#Then totals the values and divides the total by each value to get it's
#frequency value and store it in the dictionary.
def generateDictionary(dictionary, file):
	for line in file:
		for i in line:
			if i.lower() not in dictionary:
				dictionary[i.lower()] = 1
			else:
				dictionary[i.lower()] = dictionary.get(i.lower()) + 1

	if '\n' in dictionary:
		del dictionary['\n']
	if ' '  in dictionary:
		del dictionary[' ']

	
	total = 0
	for i in dictionary:
		total += dictionary.get(i)
	for i in dictionary:
		dictionary[i] = dictionary.get(i) / total

# Gerenrates the Frequency List, sorts it, then puts it in reverse order
def generateFrequencyList(dictionary, freqencyList):
	for i in dictionary:	
			freqencyList.append(dictionary.get(i)) 

	freqencyList.sort()
	freqencyList = freqencyList[::-1]
	return freqencyList

#Creates a cirlce that is the color Bisque based off radius.
def createCircle(radius):
	penup()
	forward(radius)		
	left(90)
	pendown()
	color('bisque')
	begin_fill()
	circle(radius)
	end_fill()
	home()

#When button is pressed it take the value from the entry widget and creates
#a dictionary and a frequency list based on this dictionary. then proceeds to
#draw pie slices next to each other based off their frequency and prints their 
#frequency
def makePieChart(window, entry, n):
	n = n.get()

	LettersDict = d = {}
	freqencyList = []
	f = open('Words.txt', 'r')
	generateDictionary(d, f)
	freqencyList = generateFrequencyList(d, freqencyList)


	if n > 0 and  n <= len(d):
		canvas = Canvas(window, width=400, height=400)
		canvas.pack
		drawTurtle = RawTurtle(canvas)

	
		radius = 200
	
		r = lambda: random.randint(0,255)
		colormode(255)
		firstR = r()
		firstG = r()
		firstB = r()
		createCircle(radius)		

		color(firstR, firstG, firstB)
		forward(radius)
		penup()
		addedAngles = 0
		addedPercents = 0
		for i in range(0, n):
			currentR = r()
			currentG = r()
			currentB = r()
			cut = freqencyList[i] * 360
			halfCut = cut /2
			currentAngle = cut
			pendown()

			if i == 0:
				color(firstR, firstG, firstB)
			else:
				color(currentR, currentG, currentB)

			begin_fill()
			left(90)
			circle(200, halfCut)

			penup()
			right(90)
			forward(25)
			letter = list(d.keys())[list(d.values()).index(freqencyList[i])]
			d.pop(letter)
			output = letter + ": " + str(round(freqencyList[i], 4))
			color('black')
			write(output, align='center',font=("Arial", 11, "normal"))
			right(180)
			forward(25)
			right(90)
			pendown()
			if i == 0:
				color(firstR, firstG, firstB)
			else:
				color(currentR, currentG, currentB)


			circle(200, halfCut)
			penup()
			pendown()
			addedAngles += cut
			addedPercents += freqencyList[i]
			home()
			end_fill()
			penup()
			setheading(addedAngles)
			forward(radius)

		left(90)
		allOthers = 1 - addedPercents
		cut = (allOthers * 360) /2
		penup()
		circle(200, cut)
		right(90)
		forward(60)
		color('black')
		output = "All Other Letters: " + str(round(allOthers, 4))
		write(output, align='center',font=("Arial", 11, "normal"))
		home()

	else:
		print("Number is either above the number of letters in the file or less than")


	window.destroy()


def main():
	window = Tk()
	window.title("Pie Chart")
	window.attributes("-topmost", True)
	
	label = Label(window, text="Please enter a number").pack()
	n = IntVar()
	entry = Entry(window, textvariable = n)
	entry.pack()
	entry.focus_set()

	button = Button(window, text='Enter', command= lambda : makePieChart(window, entry, n))
	button.pack()
		
	window.mainloop()

if __name__ == "__main__":
	main()
